# –ê–≤—Ç–æ-–°–∏–Ω—Ö—Ä–æ–Ω —á–µ–∫–æ–≤ –∏–∑ `–ÆKassa` –≤ `–ú–æ–π –ù–∞–ª–æ–≥` –¥–ª—è —Å–∞–º–æ–∑–∞–Ω—è—Ç—ã—Ö (–ù–ü–î)

> **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –ø–ª–∞—Ç–µ–∂–µ–π –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –ÆKassa –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–ú–æ–π –ù–∞–ª–æ–≥"

–î–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –±—ã–ª —Å–æ–∑–¥–∞–Ω –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ —Å–≤—è–∑–∏ —Å —Ç–µ–º, —á—Ç–æ **–ÆKassa** –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ —Å–≤–æ–π —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ-–æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ–∫–æ–≤ –≤ "–ú–æ–π –ù–∞–ª–æ–≥"

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ .env)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ —Å–±–æ—è—Ö —Å–µ—Ç–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker
- –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ÆKassa (Shop ID + API –∫–ª—é—á)
- –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ú–æ–π –ù–∞–ª–æ–≥ (–ª–æ–≥–∏–Ω + –ø–∞—Ä–æ–ª—å)

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É `/opt/yookassa-to-mynalog` –∏ –ø–µ—Ä–µ–π—Ç–∏ –≤ –Ω–µ–µ
```bash
mkdir /opt/yookassa-to-mynalog && cd /opt/yookassa-to-mynalog
```

### 2. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
cp .env.example .env
```

### 3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
nano .env
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|---------|
| `YOOKASSA_SHOP_ID` | ID –º–∞–≥–∞–∑–∏–Ω–∞ –≤ –ÆKassa |
| `YOOKASSA_API_KEY` | API –∫–ª—é—á –ÆKassa |
| `MOY_NALOG_LOGIN` | –ò–ù–ù –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω –≤ –ú–æ–π –ù–∞–ª–æ–≥ |
| `MOY_NALOG_PASSWORD` | –ü–∞—Ä–æ–ª—å –≤ –ú–æ–π –ù–∞–ª–æ–≥ |

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|:----------:|---------|
| `SYNC_START_DATE` | -24—á | –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (YYYY-MM-DD) |
| `INCOME_DESCRIPTION_TEMPLATE` | `–ü–ª–∞—Ç–µ–∂ #{order_id}` | –®–∞–±–ª–æ–Ω –æ–ø–∏—Å–∞–Ω–∏—è –¥–æ—Ö–æ–¥–∞ |
| `CRON_SCHEDULE` | `0 */4 * * *` | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ cron (–∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞) |

### –ü—Ä–∏–º–µ—Ä—ã CRON_SCHEDULE

```env
CRON_SCHEDULE='0 * * * *'        # –∫–∞–∂–¥—ã–π —á–∞—Å
CRON_SCHEDULE='0 */6 * * *'      # –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
CRON_SCHEDULE='0 12 * * *'       # –æ–¥–∏–Ω —Ä–∞–∑ –≤ –¥–µ–Ω—å –≤ 12:00
CRON_SCHEDULE='*/30 * * * *'     # –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
CRON_SCHEDULE='0 0 * * 0'        # –æ–¥–∏–Ω —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
```

**–§–æ—Ä–º–∞—Ç cron:** `–º–∏–Ω—É—Ç—ã —á–∞—Å—ã –¥–Ω–∏_–º–µ—Å—è—Ü–∞ –º–µ—Å—è—Ü—ã –¥–Ω–∏_–Ω–µ–¥–µ–ª–∏`

## üöÄ –ó–∞–ø—É—Å–∫

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
```bash
docker-compose build --no-cache
docker-compose up -d
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
```bash
docker logs -f yookassa-to-mynalog
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
docker-compose down
```

### –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
```bash
docker-compose restart
```

## üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `python main.py` –æ–¥–∏–Ω —Ä–∞–∑
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
   
2. **–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
   - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∂–∏–º cron
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π:**
   - –ü–æ–ª—É—á–∞—é—Ç—Å—è –Ω–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –∏–∑ YooKassa
   - –ö–∞–∂–¥—ã–π –ø–ª–∞—Ç–µ–∂ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ú–æ–π –ù–∞–ª–æ–≥
   - –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `sync_state.json`

## üìÅ –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ main.py                 # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt        # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ Dockerfile              # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml      # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ entrypoint.sh           # –°—Ç–∞—Ä—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ .env.example            # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ sync_state.json         # –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ sync.log                # –õ–æ–≥–∏ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```bash
docker ps | grep yookassa-to-mynalog
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
docker logs --tail=50 yookassa-to-mynalog

# –í —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker logs -f yookassa-to-mynalog
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```bash
docker exec yookassa-to-mynalog cat sync_state.json
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª–Ω–æ–≥–æ –ª–æ–≥–∞
```bash
docker exec yookassa-to-mynalog tail -100 sync.log
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `.env` –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ 4 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: `docker-compose restart`

### –û—à–∏–±–∫–∞: "–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–ö–æ–¥ 401)"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è –¥–ª—è –ú–æ–π –ù–∞–ª–æ–≥. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤—Ä—É—á–Ω—É—é –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** 
```bash
docker logs yookassa-to-mynalog    # –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—à–∏–±–∫—É
docker-compose down                 # –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
docker-compose build --no-cache     # –ø–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—å
docker-compose up -d                # –∑–∞–ø—É—Å—Ç–∏—Ç—å
```

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `CRON_SCHEDULE` –≤ `.env`. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω: `docker ps`

## üìù –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä
```env
YOOKASSA_SHOP_ID='your_shop_id'
YOOKASSA_API_KEY='your_api_key'
MOY_NALOG_LOGIN='your_login'
MOY_NALOG_PASSWORD='your_password'
```

### –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä
```env
YOOKASSA_SHOP_ID='your_shop_id'
YOOKASSA_API_KEY='your_api_key'

MOY_NALOG_LOGIN='your_login'
MOY_NALOG_PASSWORD='your_password'

SYNC_START_DATE='2026-01-01'

INCOME_DESCRIPTION_TEMPLATE='–ü–ª–∞—Ç–µ–∂ #{order_id}'

CRON_SCHEDULE='0 */4 * * *'
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤

```
2026-01-21 12:00:00,123 - INFO - –ù–∞—á–∞–ª–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏...
2026-01-21 12:00:01,456 - INFO - ‚úì –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ –ú–æ–π –ù–∞–ª–æ–≥.
2026-01-21 12:00:02,789 - INFO - ‚úì –ù–∞–π–¥–µ–Ω–æ –Ω–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π: 3
2026-01-21 12:00:03,012 - INFO - ‚úì –î–æ—Ö–æ–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: 500 —Ä—É–±. –∑–∞ '–ü–ª–∞—Ç–µ–∂ #12345'
...
2026-01-21 12:00:05,000 - INFO - –†–µ–∑—É–ª—å—Ç–∞—Ç: —É—Å–ø–µ—à–Ω–æ=3, –æ—à–∏–±–æ–∫=0
2026-01-21 12:00:05,001 - INFO - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ!**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ñ–∞–π–ª `.env` –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –ù–µ –¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ª–æ–≥–∞–º (–º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é)

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `yookassa` - API –ÆKassa
- `httpx` - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π HTTP –∫–ª–∏–µ–Ω—Ç
- `python-dotenv` - –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `tenacity` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker logs yookassa-to-mynalog`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.env` –∑–∞–ø–æ–ª–Ω–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
4. –ü–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: `docker-compose build --no-cache`

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

**–í–µ—Ä—Å–∏—è:** 2.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-21
